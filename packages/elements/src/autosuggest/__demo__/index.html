<!DOCTYPE html>
<html lang="">
  <head>
    <meta charset="utf-8" />
    <title>Autosuggest</title>
    <style type="text/css">
      .container {
        display: flex;
        flex-direction: column;
      }

      ef-text-field {
        width: 300px;
      }
    </style>
  </head>
  <body>
    <script type="module">
      import '@refinitiv-ui/elements/autosuggest';
      import '@refinitiv-ui/elements/button';
      import '@refinitiv-ui/elements/checkbox';
      import '@refinitiv-ui/elements/header';
      import '@refinitiv-ui/elements/item';
      import '@refinitiv-ui/elements/multi-input';
      import '@refinitiv-ui/elements/select';
      import '@refinitiv-ui/elements/text-field';
      import '@refinitiv-ui/elements/tooltip';

      import '@refinitiv-ui/demo-block';
      import '@refinitiv-ui/demo-block/demo.css';

      // Dynamic import theme files from search params of the URL
      // Ex. http://localhost:3000?theme=halo&varint=dark will load halo-theme/dark
      const url = new URL(window.location);
      const theme = url.searchParams.get('theme') || 'halo';
      const variant = url.searchParams.get('variant') || 'light';

      if (!window.location.search) {
        url.searchParams.set('theme', theme);
        url.searchParams.append('variant', variant);
        window.location.search = url.searchParams.toString();
      }

      import(`../../../../../node_modules/@refinitiv-ui/${theme}-theme/${variant}/css/native-elements.css`);
      import(`../../../lib/autosuggest/themes/${theme}/${variant}/index.js`);
      import(`../../../lib/text-field/themes/${theme}/${variant}/index.js`);
    </script>

    <demo-block layout="normal" header="Default" tags="Default, Paging, Grouped, Async, Accessibility">
      <div id="abcDiv"></div>
      <script type="module">
        const div = document.createElement('div');
        const shadow = abcDiv.attachShadow({ mode: 'open' });
        shadow.appendChild(div);
        // add text field and autosuggest
        const textField = document.createElement('ef-text-field');
        const autosuggest = document.createElement('ef-autosuggest');
        textField.placeholder = "Type 'e'";
        textField.setAttribute('id', 'input');
        autosuggest.attach = textField;
        const data = [{ label: 'Cornelius Martin' }, { label: 'Memphis Hoover' }, { label: 'Angela Lloyd' }];
        autosuggest.addEventListener('suggestions-fetch-requested', (event) => {
          let query = event.detail.query;
          let re = new RegExp(autosuggest.constructor.EscapeRegExp(query), 'i');

          autosuggest.suggestions = query ? data.filter((item) => re.test(item.label)) : [];
        });
        shadow.appendChild(textField);
        shadow.appendChild(autosuggest);
      </script>
    </demo-block>
  </body>
</html>
